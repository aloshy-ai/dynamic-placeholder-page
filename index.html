<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Placeholder Page | aloshy.ðŸ…°ðŸ…¸</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #000;
            font-family: Arial, sans-serif;
        }

        .background-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            object-fit: cover;
            transition: opacity 2s ease-in-out;
            animation: kenBurns 20s ease-in-out infinite alternate;
            animation-play-state: paused;
        }

        .background.active {
            opacity: 1;
            animation-play-state: running;
        }

        @keyframes kenBurns {
            0% {
                transform: scale(1) translate(0, 0);
            }
            25% {
                transform: scale(1.05) translate(-1%, -1%);
            }
            75% {
                transform: scale(1.08) translate(1%, 1%);
            }
            100% {
                transform: scale(1.12) rotate(1deg);
            }
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(
                45deg,
                rgba(255, 100, 100, 0.6),
                rgba(100, 100, 255, 0.6),
                rgba(100, 255, 100, 0.6),
                rgba(255, 100, 100, 0.6),
                rgba(100, 100, 255, 0.6)
            );
            mix-blend-mode: overlay;
            animation: gradientFlow 8s linear infinite;
            background-size: 400% 400%;
        }

        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .hostname {
            color: #fff;
            font-weight: 900;
            text-transform: uppercase;
            position: fixed;
            text-align: center;
            white-space: nowrap;
            font-size: 50%;
        }

        @media (orientation: portrait) {
            .hostname {
                transform: rotate(-90deg);
            }
        }

        .credits-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo-text {
            display: flex;
            align-items: center;
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
        }

        .credits-link {
            display: flex;
            align-items: center;
            gap: 0.4rem;
            padding: 0.5rem 0.75rem;
            background-color: rgba(31, 41, 55, 0.9);
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            transition: background-color 0.2s;
            color: rgb(229, 231, 235);
            text-decoration: none;
            font-family: system-ui, -apple-system, sans-serif;
            font-weight: 100;
        }

        .credits-link:hover {
            background-color: rgb(31, 41, 55);
            cursor: pointer;
        }

        .credits-logo {
            height: 0.8rem;
        }

        .logo-text-mono {
            font-family: monospace;
        }

        .logo-text-a {
            color: rgb(239, 68, 68);
        }

        .logo-text-i {
            color: white;
        }
    </style>
</head>
<body>
    <div class="background-container">
        <img class="background" alt="Dynamic background">
        <img class="background" alt="Dynamic background">
    </div>
    <div class="overlay"></div>
    <!-- <div class="hostname"></div> -->
    <div class="credits-container">
        <div class="logo-section">
            <div class="logo-text">
                <span class="logo-text-mono">aloshy.</span>
                <span class="flex items-center">
                    <span class="logo-text-a">ðŸ…°</span>
                    <span class="logo-text-i">ðŸ…¸</span>
                </span>
            </div>
        </div>
        <div class="credits-banner">
            <a href="https://civitai.com" target="_blank" rel="noopener noreferrer" class="credits-link">
                <span>SOURCE</span>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 107 22.7" class="credits-logo">
                    <defs>
                        <linearGradient id="prideGradient" gradientTransform="rotate(45)">
                            <stop offset="0%" stop-color="#E04A4A"/>
                            <stop offset="20%" stop-color="#E04A4A"/>
                            <stop offset="40%" stop-color="#E0B54A"/>
                            <stop offset="60%" stop-color="#4AE0D4"/>
                            <stop offset="80%" stop-color="#4A6AE0"/>
                            <stop offset="100%" stop-color="#D44AE0"/>
                        </linearGradient>
                    </defs>
                    <g>
                        <path fill="rgb(229, 231, 235)" d="M20.8,1.7H3.7L1.5,4.1v15l2.3,2.3h17.1v-5.2H6.7V7h14.1V1.7z"/>
                        <path fill="rgb(229, 231, 235)" d="M76.1,1.7H56.6V7h7.2v14.3H69V7h7C76,7,76.1,1.7,76.1,1.7z M23.2,1.8v19.5h5.2V1.8C28.4,1.8,23.2,1.8,23.2,1.8z M30.8,1.8 v19.5h7.6l8.3-8.3V1.8h-5.2v8.3l-5.4,6V1.8C36.1,1.8,30.8,1.8,30.8,1.8z M49.1,1.8v19.5h5.2V1.8C54.3,1.8,49.1,1.8,49.1,1.8z"/>
                        <path fill="rgb(229, 231, 235)" d="M100.3,1.8v19.5h5.2V1.8H100.3z M95.6,1.8H80.8l-2.3,2.3v17.2h5.2v-7.1h8.9v7.1h5.2V4.1C97.8,4.1,95.6,1.8,95.6,1.8z M92.7,8.9h-8.9V7h8.9V8.9z"/>
                        <path fill="url(#prideGradient)" d="M46.7,16.2v5.1h-5.1"/>
                    </g>
                </svg>
            </a>
        </div>
    </div>

    <script>
        const FALLBACK_IMAGE = 'https://www.aloshy.ai/images/bg.png';
        const ROTATION_INTERVAL = 10000; // 10 seconds
        const randomPage = Math.floor(Math.random() * 100) + 1;
        
        let imageCache = [];
        let currentImageIndex = 0;
        let backgrounds = document.querySelectorAll('.background');
        let activeIndex = 0;
        let isTransitioning = false;

        async function fetchImages() {
            try {
                const response = await fetch(`https://civitai.com/api/v1/images?limit=8&nsfw=Soft&sort=Newest&page=${randomPage()}`, {
                    headers: { 'Content-Type': 'application/json' }
                });
                
                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const data = await response.json();
                return data.items || [];
            } catch (error) {
                console.warn('Error fetching images:', error);
                return null;
            }
        }

        async function preloadImage(url) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(url);
                img.onerror = () => reject(new Error('Image load failed'));
                img.src = url;
            });
        }

        async function transition() {
            if (isTransitioning || imageCache.length === 0) return;
            
            try {
                isTransitioning = true;
                const nextIndex = (activeIndex + 1) % 2;
                
                // Get next image URL
                const imageUrl = imageCache[currentImageIndex].url;
                currentImageIndex = (currentImageIndex + 1) % imageCache.length;

                // Preload next image
                await preloadImage(imageUrl);
                
                // Update hostname
                updateHostname();

                // Set up next image
                backgrounds[nextIndex].src = imageUrl;
                
                // Trigger transition
                backgrounds[activeIndex].classList.remove('active');
                backgrounds[nextIndex].classList.add('active');
                
                // Update active index
                activeIndex = nextIndex;
                
                // Reset transition flag after animation completes
                setTimeout(() => {
                    isTransitioning = false;
                }, 2000);
            } catch (error) {
                console.warn('Error during transition:', error);
                isTransitioning = false;
            }
        }

        function showFallback() {
            backgrounds.forEach(bg => {
                bg.src = FALLBACK_IMAGE;
                bg.classList.remove('active');
            });
            backgrounds[0].classList.add('active');
            document.querySelector('.hostname').textContent = 'FALLBACK';
            adjustHostnameSize();
        }

        function adjustHostnameSize() {
            const isPortrait = window.innerHeight > window.innerWidth;
            const targetWidth = isPortrait ? window.innerHeight : window.innerWidth;
            const targetSize = targetWidth * 0.48;
            
            const hostnameEl = document.querySelector('.hostname');
            hostnameEl.style.fontSize = '1px';
            const ratio = targetSize / hostnameEl.offsetWidth;
            hostnameEl.style.fontSize = `${ratio}px`;
        }

        function updateHostname() {
            try {
                const currentUrl = window.location.href;
                const url = new URL(currentUrl);
                document.querySelector('.hostname').textContent = url.hostname.split('.')[0].toUpperCase();
                adjustHostnameSize();
            } catch (error) {
                console.warn('Error updating hostname:', error);
            }
        }

        // Initialize
        (async () => {
            try {
                const fetchedImages = await fetchImages();
                
                // Show fallback only if API failed
                if (!fetchedImages) {
                    showFallback();
                    return;
                }

                // Filter out any invalid URLs and store valid ones
                for (const image of fetchedImages) {
                    try {
                        await preloadImage(image.url);
                        imageCache.push(image);
                    } catch (error) {
                        console.warn('Failed to load image:', image.url);
                    }
                }

                // If no valid images after checking all URLs, show fallback
                if (imageCache.length === 0) {
                    showFallback();
                    return;
                }

                // Set up first image
                const firstImage = imageCache[0];
                backgrounds[0].src = firstImage.url;
                backgrounds[0].classList.add('active');
                
                // Set initial hostname
                updateHostname();

                // Start rotation
                setInterval(transition, ROTATION_INTERVAL);
            } catch (error) {
                console.warn('Error in initialization:', error);
                showFallback();
            }
        })();

        // Handle window resize
        window.addEventListener('resize', adjustHostnameSize);
    </script>
</body>
</html>
